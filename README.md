My project was inspired by an instagram post made by 'designrulesco' from July 2024, link to the original post is [here](https://www.instagram.com/reel/C9foI0USKJb/).
Further info on their [product webisite](https://www.designrules.co/) where they sell metro-styled maps of 
cities in the USA, where the stations illuminate whenever a train is departing from them.

My goal was to do just that, but here in Vienna :)

Fortunately WienerLinien, the company operating the Vienna metro provides a real-time API system, 
through which in particular one can request future departures for each station. No API-key required.
Documentation and further informations can be found here: https://www.wienerlinien.at/ogd_realtime/doku/ .
In the following I want to give a short introduction on how I used this service to create the 'WienerLinienMonitor'.

The metro system consists currently of 109 stations, with stations served by more than one line counted for each line. 
A geographical location of all metro stations generated by 'WienerLinien.ipynb'

<img width="320" height="247" alt="grafik" src="https://github.com/user-attachments/assets/5c74a0bc-9266-4273-a659-77fb20f6b9c9" />

Given the fair-use principle of the API (request as little data as possible) and statement that the interval between two requests should not be less than 15 seconds, this presents a challenge of how to continuously retrieve up-to-date data across the entire metro system.
During numerous iterations, I followed different strategies, a few of which should be listed below.
1. It suffices to only rely on data from a few stations (as equidistant spaced as possible) and interpolate the departure times.
2. The choice of stations that are meassured should reflect the current service of the metro (e.g. if a line is not in service end-to-end, but is divided into two independently operating lines).
3. If we could assign every station a value for the 'necessity' of update during runtime and dynamically depending on current data, we could only update those.
4. Stations serving more than one line include more data per requested station, therefore appear to be more valuable.
5. Only handling one line at a time reduces complexity and difficulty.
6. Data only reflects where a train is headed to, so lines with more then one terminal station per direction have to be meassured past every intermediate terminal station in order to track the origin station of a train correctly.

Point 3 would be highly desirable if implemented efficiently and correctly, 
but I consider it to be too prone for 'bias' towards certain stations, giving insufficient data on the rest of the system.
Combining Point 1, 4 and 6 was my first strategy, but complexity of handeling the data, in particular the incomplete picture one has in the case where only given departure data of one station for a single line at a time, made it susceptible for errors when matching older data to this new data.
Hence for this version I settled with Point 5 additionally to the Points 1, 2 and 6. The current operating state of the metro is computed at the begining of the program.
For this a set of stations is given by the value 'initial_meassure' in the file 'Config.ini'. 
These might need to be changed, if continuos service of any line is interrupted.
The program requests departure data from all those stations at once, computing for each line the terminal stations most distant to the station meassured (these are called service intervals) as well as for each line a set of terminal stations (for both directions at a time). The departure data is then discarded, since it is not of use anymore and from the service intervals and terminal stations the to be meassured stations are then determined. A visualisation (printed to 'monitor.log') might look like this:
<img width="943" height="200" alt="grafik" src="https://github.com/user-attachments/assets/54f832c1-6cca-4d74-a2ff-8d370a5a112a" />
